{ WRITE } = require 'coffee-standards'

# GLOBAL
sessions = new Map()

# MAIN
CHECK_SES = (uname, ip) ->
	match = sessions.get ip
	if match
		match == uname
	else
		false

TRACK_SES = (ip, uname, ws) ->
	val =
		username: uname
		ws: ws
	sessions.set ip, val

UNTRACK_SES = (ip) ->
	sessions.delete ip

LIST_SES = (uname) ->
	[...sessions.entries()]
		.filter((entry) ->
			entry[1].username == uname)

LIST_SES_IP = (uname) ->
	TO_IP = (session) ->
		session[0]

	return LIST_SES uname
		.map TO_IP

# EXPORT
module.exports =
	CHECK_SES: CHECK_SES,
	TRACK_SES: TRACK_SES,
	UNTRACK_SES: UNTRACK_SES,
	LIST_SES: LIST_SES,
